from selenium import webdriver
from selenium.webdriver.support.select import Select
import requests
from bs4 import BeautifulSoup
import pandas as pd
import numpy as np

driver = webdriver.Chrome('C:/Users/user/chromedriver.exe')    #chromedriver location
driver.get('http://asbc.iis.sinica.edu.tw/index_range.htm')
soup=BeautifulSoup(driver.page_source)
driver.find_element_by_xpath("//body/form[@name='form1']//input[@name='Submit']").click()
# 查詢關鍵字網址: http://asbc.iis.sinica.edu.tw/index2.asp



target=str(input("請輸入要找尋的文字："))
id=driver.find_element_by_name('inputword')
id.send_keys(target)
driver.find_element_by_xpath("//body/div/table//form[@name='form1']//input[@value='送出']").click()


long=int(input("輸入要找的量數："))

table=soup.find('table', border="0", cellspacing="0", width="100%")
for i in soup.find('table', border="0", cellspacing="0", width="100%"):
    for Len in range(1, long):                      
        right=soup.find_all("div")[Len].text.replace("more","")
        main=soup.find_all("b")[Len].text
        left=soup.find_all("td", width="501")[Len].text.replace("more","")
        print(right,main,left) 
